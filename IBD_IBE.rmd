---
title: "IBD"
author: "Michelle DePrenger-Levin"
date: "November 17, 2016"
output: html_document
---

```{r}
library(raster)
library(rgdal)
library(maptools)
library(devtools)
library(ecodist)
library(vegan)
library(MASS)
library(prism)
library(dismo)
library(ggplot2)
library(Imap)

```

Pairwise distance matrix
```{r}
ph.dist <- read.csv("Q:/Research/Lab/Projects/Phacelia formosula/Project Information/Phacelia project information with GPS centroids 2016_pdm.csv")

head(ph.dist)
#convert Northing Easting to lat long

ph.ll <- spTransform(SpatialPoints(cbind(ph.dist$Easting,ph.dist$Northing),
                          proj4string = CRS("+proj=utm +zone=13 + datus=WGS84")),
            CRS("+proj=longlat +datum=WGS84"))

ph.lls <- data.frame(coordinates(ph.ll))

pairdist <- lapply(2:nrow(ph.lls), function(x){
  gdist(lat.1=ph.lls$coords.x2[x-1], lon.1 = ph.lls$coords.x1[x-1], 
        lat.2=ph.lls$coords.x2[x], lon.2 = ph.lls$coords.x1[x], units = "m")
})


ph.dist.eu <- dist(ph.lls)

write.table(ph.dist.eu, "clipboard", sep="\t", row.names=FALSE, col.names = FALSE)
ph.dist$Population

```


ape
ade4

Isolation by distance (IBD) and Isolation by environment (IBE)
1) Mantel test
vegan - Forester et al 2016    
spatial eigenfunction analysis and multivariate linear regression (Diniz-Filho et al. 2013 and Legendre et al. 2015)  
i - PCoA to pairwise multivariate genetic distance matrix (Bray-Curtis)
ii - keep PCoA axes based on the broken-stick criterion (Legendre & Legendre 2012)   
iii - response data = kept axes, for redundancy analysis - mutivariate linear regression (RDA)
iv - predictors are spatial eigenfunctions (distance-based Moran's eigenvector maps, dbMEMs)
v - forward selection to reduce number of dbMEMs (Blanchet et al. 2008)
vi - calcuate r^2 assess signficantion using 1000 permutations   
<https://github.com/rforge/sedar/tree/master/pkg> 
both PCNM and packfor
```{r}
library(devtools)
#install.packages("vegan")
#install_github("vegandevs/vegan")
library(vegan)
#install.packages("PCNM") # not avaliable for 3.3.1, a funciton in vegan?
?pcnm
library(boot)
?packfor
#install_git("rforge/sedar/pkg/AEM")
#install_github("rforge/sedar/pkg/PCNM")

#install.packages("ecodist")
library(ecodist)



```


soils <https://www.nrcs.usda.gov/wps/portal/nrcs/detail/soils/survey/?cid=nrcs142p2_053627>
Data from USDA <http://websoilsurvey.nrcs.usda.gov/app/WebSoilSurvey.aspx>   
 1. Analsis Tools -> Overlay -> Spatial Join 2. In spatial join dialog box: -Target features = Points -Join features = Polygons -Join Operation = Join one to one -Right click on 'yield' field in join feature field map, select properties, choose 'Maximum' as merge rule -Match option = Intersect 
Try to get netCDF data for these points
```{r}
soils <- read.delim("Q:/Research/All_Projects_by_Species/Phacelia SPECIES/Phacelia_formosula/Phacelia formosula_abiotic/Walden_Phacelia/SoilsPerPoints.txt",
                    sep = ",")

head(soils)
soils$Population <- gsub('[[:digit:]]+', '', soils$Comment)
soils$Population[soils$Comment == " "] <- "TroublesomeCreek"
unique(soils$Population)

soils$Population[grep("WSE", soils$Population)] <- "WeatherStation"
soils$Population[grep("Brownlee", soils$Population)] <- "Brownlee"
soils$Population[grep("RNA", soils$Population)] <- "ResearchNaturalArea"
soils$Population[grep("iamond", soils$Population)] <- "DiamondJNE"

```


Diniz-Filho et al 2013   
```{r}
library(raster)
library(prism)

options(prism.path = "Q:/Research/All_Projects_by_Species/Astragalus SPECIES/Astragalus_microcymbus/PRISM_asmiclimate")

#Precipitation total, rain and snow
get_prism_monthlys(type="ppt", mon = 1:12, keepZip = FALSE, years = 1980:1993)

#Maximum temperature (average)
get_prism_monthlys(type="tmax", mon = 1:12, keepZip = FALSE, years = 1980:1993)

#Minimum temperature (average)
get_prism_monthlys(type="tmin", mon = 1:12, keepZip = FALSE, years = 1980:1993)

ph.ll <- spTransform(SpatialPoints(cbind(soils$EastingAll,soils$NorthingAll),
                                   proj4string = CRS("+proj=utm +zone=13 + datum=WGS84")),
                     CRS("+proj=longlat +datum=WGS84"))
```

```{r}

ph.cols <- data.frame(coordinates(ph.ll),soils$Population,soils$Ind_Num)


maxs <- grep("tmax", ls_prism_data(absPath=TRUE)[,2])
mins <- grep("tmin", ls_prism_data(absPath = TRUE)[,2])
ppt <- grep("ppt", ls_prism_data(absPath = TRUE)[,2])

avgTemps.max <- lapply(maxs, function(x){
  rastertemps <- raster(ls_prism_data(absPath=TRUE)[x,2])
  data.frame(data = extract(rastertemps, ph.cols[,c("coords.x1","coords.x2")]), 
             date = ls_prism_data()[x,])
})

avgTemps.min <- lapply(mins, function(x){
  rastertemps <- raster(ls_prism_data(absPath=TRUE)[x,2])
  data.frame(data = extract(rastertemps, ph.cols[,c("coords.x1","coords.x2")]), 
             date = ls_prism_data()[x,])
})

avgPrecip <- lapply(ppt, function(x){
  rastertemps <- raster(ls_prism_data(absPath=TRUE)[x,2])
  data.frame(data = extract(rastertemps, ph.cols[,c("coords.x1","coords.x2")]), 
             date = ls_prism_data()[x,])
})

mins.avg <- do.call(rbind, avgTemps.min)
maxs.avg <- do.call(rbind, avgTemps.max)
ppt.avg <- do.call(rbind, avgPrecip)


```

<https://cran.r-project.org/web/packages/dismo/vignettes/sdm.pdf>   
The code above returns a raster with the 18 bioclimate variables covering the whole world with a resoltion of 2.5 minutes of degrees:
averaged over 1960-1990

BIO1 = Annual Mean Temperature
BIO2 = Mean Diurnal Range (Mean of monthly (max temp â€“ min temp))
BIO3 = Isothermality (BIO2/BIO7) (* 100)
BIO4 = Temperature Seasonality (standard deviation *100)
BIO5 = Max Temperature of Warmest Month
BIO6 = Min Temperature of Coldest Month
BIO7 = Temperature Annual Range (BIO5-BIO6)
BIO8 = Mean Temperature of Wettest Quarter
BIO9 = Mean Temperature of Driest Quarter
BIO10 = Mean Temperature of Warmest Quarter
BIO11 = Mean Temperature of Coldest Quarter
BIO12 = Annual Precipitation
BIO13 = Precipitation of Wettest Month
BIO14 = Precipitation of Driest Month
BIO15 = Precipitation Seasonality (Coefficient of Variation)
BIO16 = Precipitation of Wettest Quarter
BIO17 = Precipitation of Driest Quarter
BIO18 = Precipitation of Warmest Quarter
BIO19 = Precipitation of Coldest Quarter
```{r}
install.packages(c('raster', 'rgdal', 'dismo', 'rJava'))

#check out example file
file <- paste(system.file(package="dismo"), "/ex/bradypus.csv", sep="")
bradypus <- read.table(file, header=TRUE, sep=",")
head(bradypus)

phal <- gbif("phacelia", "alba*", geo=FALSE)
phde <- gbif("phacelia", "denticulata*", geo=FALSE)
phha <- gbif("phacelia", "hastata*", geo=FALSE)
phhe <- gbif("phacelia", "heterophylla*", geo=FALSE)
phse <- gbif("phacelia", "sericea*", geo=FALSE)

phgeo <- subset(phse, !is.na(phse$lon) & !is.na(phse$lat))


install.packages("maptools")
library(maptools)

data(wrld_simpl)
plot(wrld_simpl, xlim=c(-150,-100), ylim=c(20,70), axes=TRUE,
     col="light yellow")
points(phgeo$lon, phgeo$lat, col="orange", pch=20, cex=0.75)


bioclim <- getData("worldclim", var = 'bio', res = 2.5)

    
usa <- getData("GADM", country="USA", level=2)
colorado <- usa[usa$NAME_1 == "Colorado",]
counties <- c("Larimer","Jackson","Grand")
ph.counties <- colorado[colorado$NAME_2 %in% grep(paste(counties, collapse="|"),
                                                  colorado$NAME_2, value=TRUE),]
ph.counties <- ph.counties[ph.counties$NAME_2 != "Rio Grande",]
plot(usa)
plot(bioclim$bio1, main="Annual Mean Temperature")

#SRTM 90 Elevation
srtm <- getData('SRTM', lon= -106, lat = 41)
#mosaic enough tiles to gt them together!
srtm1 <- getData('SRTM', lon= -106, lat = 40)
strmmosaic <- mosaic(srtm, srtm1, fun=mean)

plot(strmmosaic)
plot(ph.counties, add=TRUE)

ph.p <-data.frame(coordinates(ph.points))


```
<http://www.sthda.com/english/wiki/ade4-and-factoextra-principal-component-analysis-r-software-and-data-mining>

Data cleaning
```{r}
sum(duplicated(soils[,c("EastingAll","NorthingAll")]))
#28

soils.unique <- soils[!duplicated(soils[,c("EastingAll","NorthingAll")]),]
ph.points <- spTransform(SpatialPoints(cbind(soils.unique$EastingAll,soils.unique$NorthingAll),
                                       proj4string = CRS("+proj=utm +zone=13 +datum=WGS84")),
                         CRS("+proj=longlat +datum=WGS84"))

#cross check coordinates
#Make a SpatialPointsDataFrame
library(sp)


ggplot()+
  geom_path(data=ph.counties, aes(x=long, y=lat, group=group))+
  coord_map()+
  geom_point(data=ph.p, aes(x=coords.x1, y=coords.x2))


```

Sampling bias    
with many samples, subsampling to reduce sampling bias   
ph.points == acg in example
```{r}
r <- raster(ph.points)
#cells are set to 1 degree
res(r) <- 1
# extend the extent of the RasterLayer a little
r <- extend(r, extent(r)+1)
#sample
phsel <- gridSample(ph.points, r, n=1) # must be 1 per degree cell

p <- rasterToPolygons(r)
plot(p, border='gray')
points(ph.points)
```

Background data - for when you don't have absence data   
OR pseudo-absences but these guys don't like as much
dismo to sample random points for background data
```{r}

files <- list.files(path=paste(system.file(package="dismo"), '/ex',
                               sep=''), pattern='grd', full.names=TRUE )

#mask to exclude areas with no data
mask <- raster(files[1])

#select random sample points, set seed
set.seed(1963)
bg <- randomPoints(mask, 500)

plot(!is.na(mask), legend=FALSE)
points(bg, cex=0.5)

#extent to restrict areas from which random points will be drawn
e <- extent(-80, -53, -39, -22)
bg2 <- randomPoints(mask, 50, ext=e)
plot(!is.na(mask), legend=FALSE)
plot(e, add=TRUE, col='red')
points(bg2, cex=0.5)


#Phacelia
rm(mask,bg2,rr)
mask <- raster(xmn=-107, xmx=-105,ymn=40, ymx = 41, nrow=100, ncol=100)
mask[]=runif(100*100)

plot(mask)
plot(ph.counties, add=TRUE)
points(ph.points)

rr <- mask(mask,ph.counties)

plot(rr)
plot(ph.counties, add=TRUE)

bg2 <- randomPoints(rr, 500)
plot(!is.na(mask), legend=FALSE)
plot(rr, add=TRUE, col='red')
points(bg2, cex=0.5)

#circles with a radius of 5 km
x <- circles(rasterToPoints(rr), d=5000, lonlat=TRUE)
pol <- polygons(x)

head(x@presence)
head(x@absence)

# then use rgeos package to dissolve circles (remove boundaries where overlap)
#sample from circles
samp1 <- spsample(pol, 250, type="random", iter=25)
cells <- cellFromXY(mask, samp1)
cells <- unique(cells)

xy <- xyFromCell(mask, cells)

plot(pol, axes=TRUE)
points(xy, cex=0.75, pch=20, col='blue')
```

Raster data - predictor variables    
ASCII files are slow
```{r}
#get elevation from worldclim
w <- getData('alt', country='USA')

files <- list.files(path=paste("Q:/Research/All_Projects_by_Species/aa_Shapefiles_Maps/aa_GENERAL_non-species_files/All_General_Background_Layers/World BioClim Date/bio_2-5m_bil", 
                               sep = ''),
                    pattern='grd', full.names=TRUE)

files2 <- list.files(path=paste("Q:/Research/All_Projects_by_Species/aa_Shapefiles_Maps/aa_GENERAL_non-species_files/All_General_Background_Layers/World BioClim Date",
                                sep = ''),
                     pattern='grd', full.names=TRUE)

usa.alt <- raster("Q:/Research/All_Projects_by_Species/aa_Shapefiles_Maps/aa_GENERAL_non-species_files/All_General_Background_Layers/World BioClim Date/USA1_msk_alt.grd")

m <- data.frame(long = c(max(ph.points@coords[,1]),min(ph.points@coords[,1])),
                lat = c(max(ph.points@coords[,2]),min(ph.points@coords[,2])))
cbind(m, alt = extract(w, m))

# Don't know what the .grd.vat.cpg files are
predictors <- stack(files[c(1,4:21)])

#missing projection
proj4string(predictors) <- CRS("+proj=longlat +datum=WGS84")
proj4string(usa.alt) <- CRS("+proj=longlat +datum=WGS84")

names(predictors)
plot(predictors)
plot(usa.alt)

predictors <- crop(predictors, extent(r)+1)
predictor.alt <- crop(files2)

plot(predictors)

plot(predictors,1)
plot(ph.counties, add=TRUE)
points(ph.points, col="blue", pch =20, cex = 0.5)

```

Create new predictor variables - example: use land cover data and focal() and create new variable that indicates how much forest area is available within Xkm of a grid cell..
```{r}
?focal

```

#Extract values from rasters
```{r}
presvals <- extract(predictors, ph.points)
altvals <- extract(usa.alt, ph.points)

cnts <- extract(ph.counties, ph.points)

#set random seed to always create same random set of points
set.seed(0)

backgr <- randomPoints(predictors, 500)

absvals <- extract(predictors, backgr)

# row for each point 
pb <- c(rep(1, nrow(presvals)), rep(0, nrow(absvals)))
cnts <- c(cnts$NAME_2, rep(0, nrow(absvals)))
site <- c(soils.unique$Population, rep(0, nrow(absvals)))
sdmdata <- data.frame(cnts, site, pb, rbind(presvals, absvals))

#categorical variables   
#SKIP
sdmdata[,'biome'] <- as.factor(sdmdata[,'biome'])

head(sdmdata)
table(sdmdata$cnts)

pairs(sdmdata[,4:22], cex=0.1, fig=TRUE)

#sdmdata[,3:22] <- sapply(sdmdata[,3:22], function(num) as.numeric(num))
```

#Model fitting   
pb - presence vs background points for the three phacelia species
```{r}
m1 <- glm(pb ~ bio1 + bio13 + bio2 + bio3 + bio4 + bio9, data=sdmdata)
class(m1)

summary(m1)

bc <- bioclim(presvals[,c('bio1','bio13','bio2','bio3','bio4','bio9')])
class(bc)
pairs(bc)
```

#Model evaluation
```{r}
#training data set
samp <- sample(nrow(sdmdata), round(0.75 * nrow(sdmdata)))
traindata <- sdmdata[samp,]

traindata <- traindata[traindata[,'pb'] == 1, -(1:3)]

testdata <- sdmdata[-samp,]
bc <- bioclim(traindata)

e <- evaluate(testdata[testdata$pb==1,], testdata[testdata$pb==0,], bc)
plot(e, 'ROC')

#Really want a k-fold data partitioning instead of single random sample
#### START HERE on page 39 of the sdm vignette

```



```{r}
#too many, take out highly correlated ones
cutoff <- 0.75
cor.table <- cor(sdmdata[,-(1:3)])
data <- as.data.frame(as.table(cor.table))
combins <- combn(colnames(cor.table),2,FUN=function(x) paste(x,collapse="_"))
cor.data <- data[data$Var1 != data$Var2, ]
data <- cor.data[paste(cor.data$Var1, cor.data$Var2, sep="_") %in% combins,]
exclude1 <- paste(data$Var2[abs(data$Freq)>cutoff],sep=",")
exclude2 <- paste(data$Var1[abs(data$Freq)>cutoff],sep=",")


#Which are correlated? 
data.cor <- data[abs(data$Freq)>cutoff,]
correlated <- c(grep(paste(c(exclude1,exclude2), collapse="|"),names(sdmdata), value=TRUE))

pairs(sdmdata[,correlated], cex=0.1, fig=TRUE)

forstep <- sdmdata[,c(grep(paste(exclude1, collapse="|"),
                            names(sdmdata), value=TRUE, invert=TRUE))]

pairs(forstep[,-(1:3)])

pairs(sdmdata[,c(unique(exclude2),unique(exclude1))])
```

Step regression - which factors explain differences in species   
convergence issues: logistf <http://cran.r-project.org/web/packages/logistf/logistf.pdf>
```{r}
glm(cnts~bio1+bio13+bio13+bio2+bio3+bio4+bio9,
    data=forstep[cnts!="0",], family = binomial, control = list(maxit=50))

step1 <- step(glm(cnts~bio1+bio13+bio13+bio2+bio3+bio4+bio9,
                 data=forstep, family=binomial),control = list(maxit=70))

#Don't need the background points for these
ggplot(sdmdata[cnts!="0",], aes(x=cnts, y=bio2))+
  geom_boxplot()

# 3 same for Larimer and Grand
ggplot(sdmdata[cnts!="0",], aes(bio1,bio4,colour=cnts))+ 
  geom_point()

#15 splits Jackson
ggplot(sdmdata[cnts!="0",], aes(bio1,bio3,colour=cnts))+ 
  geom_point()

ggplot(sdmdata[cnts!="0",], aes(bio1,bio2,colour=cnts))+ 
  geom_point()

ggplot(sdmdata[cnts!="0",], aes(bio1,bio13,colour=cnts))+ 
  geom_point()

ggplot(sdmdata[cnts!="0",], aes(bio1,bio9,colour=cnts))+ 
  geom_point()


```

Environmental factors and background points
```{r}
ggplot(sdmdata, aes(x=cnts, y=bio15))+
  geom_boxplot()

ggplot(sdmdata, aes(x=cnts, y=bio1))+
  geom_boxplot()

ggplot(sdmdata, aes(x=cnts, y=bio2))+
  geom_boxplot()

ggplot(sdmdata, aes(x=cnts, y=bio13))+
  geom_boxplot()

ggplot(sdmdata, aes(x=cnts, y=bio9))+
  geom_boxplot()



```



#Ignore Grand
```{r}
sdmdata.phfo.phsc <- sdmdata[cnts=="Jackson"|cnts=="Larimer",]
sdmdata.phfo.phsc$cnts <- factor(sdmdata.phfo.phsc$cnts)

step1 <- step(glm(cnts~bio10+bio13+bio15+bio18+bio2+bio8,
                 data=sdmdata.phfo.phsc, family=binomial),control = list(maxit=70))

ggplot(sdmdata.phfo.phsc, aes(bio2, bio18, colour=cnts))+
  geom_point()+
  stat_ellipse()

ggplot(sdmdata.phfo.phsc, aes(bio6, bio14, colour=cnts))+
  geom_point()

```




<https://www.rforge.net/doc/packages/climates/html/bioclim.html>
```{r}
install.packages("climates") #nope, how?!


```


Now have environmental variables (by going through the sdm vignette)
follow vegan tutorial, trying to get environmental variables   
<http://cc.oulu.fi/~jarioksa/opetus/metodi/vegantutor.pdf>
```{r}


```


ecodist   
simple mantel statistic  - degree of dissimilarity in one datset compared to detree of dissimilarity in another independently-derived dataset   
<https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3873175/>   
<http://www.molecularecologist.com/2015/06/ibeibd-contour-plots-in-r/>  

Forester et al. 2016 Molecular Ecology 
##### START HERE #####
1) PCA 
2) RDA reduncancy analysis : contrained ordination extends linear regression to multivariate response data to maximize proportion of response variable that is explained. (response variables: genetic data; linear comintation of predictor variables (environemtnal data)) 
```{r}
library(labdsv)
vegdist()

ph.df <- genind2df(ph1)
head(ph.df)
ph.df <- as.data.frame(ph.df)
ph.df[,2:13] <- sapply(ph.df[,2:13], function(x) as.numeric(x))

ph.vegdist <- vegdist(ph.df[,-1], method = "bray", na.rm = TRUE)
disana(ph.vegdist)

ph.pco <- pco(ph.vegdist)
ph.pco$eig

barplot(ph.pco$eig)

ph.genepop <- genind2genpop(ph1)
tab(ph.genepop)
```

<http://adegenet.r-forge.r-project.org/files/tutorial-basics.pdf>  
Some of this would work better for the environmental variables
```{r}
ph.tab <- tab(ph.genepop, NA.method="mean")
ph.pca <- dudi.pca(ph.tab, scannf=TRUE, scale=FALSE) # nf = 3  #can determine number dimensions in teh final results

summary(ph.pca)
phxy <- ph.pca$co

s.corcircle(phxy, label = row.names(phxy), grid = TRUE,
            box = FALSE)

temp <- as.integer(pop(ph1))
myCol <- transp(c("red","blue"),.7)[temp]
myPch <- c(15:17)[temp]

plot(ph.pca$li)
plot(ph.pca$li, col = myCol, pch=myPch) 

## use wordcloud for non-overlapping labels
library(wordcloud)
textplot(ph.pca$li[,1], ph.pca$li[,2], words=rownames(ph.tab), cex=1.4, new=FALSE)

## legend the axes by adding loadings
#abline(h=0,v=0,col="grey",lty=2)
#s.arrow(ph.pca$c1*.5, add.plot=TRUE)
legend("topright", pch=c(15,17), col=transp(c("blue","red"),.7),
leg=c("Group A","Group B"), pt.cex=2)


```

Pluess et al 20016 New Phytologist
```{r}
#Variable factor map
pca.space <- princomp(pca.ph[,-(1:3)], cor=TRUE)
summary(pca.space)
ph.load <- loadings(pca.space)
ph.pc <- predict(pca.space)

ph.pc <- data.frame(ph.pc, pca.ph)

summary(lm(Comp.1~alt, data=ph.pc))

rm(ph.pc)
#PCA of factors
pca.ph <- sdmdata[cnts!="0",]
pca.ph$alt <- altvals

cutoff <- 0.75
cor.table <- cor(pca.ph[,-(1:3)])
data <- as.data.frame(as.table(cor.table))
combins <- combn(colnames(cor.table),2,FUN=function(x) paste(x,collapse="_"))
cor.data <- data[data$Var1 != data$Var2, ]
data <- cor.data[paste(cor.data$Var1, cor.data$Var2, sep="_") %in% combins,]
exclude1 <- paste(data$Var2[abs(data$Freq)>cutoff],sep=",")
exclude2 <- paste(data$Var1[abs(data$Freq)>cutoff],sep=",")


#Which are correlated? 
data.cor <- data[abs(data$Freq)>cutoff,]
correlated <- c(grep(paste(c(exclude1,exclude2), collapse="|"),names(pca.ph), value=TRUE))

pairs(pca.ph[,correlated[1:5]], cex=0.1, fig=TRUE)
pairs(pca.ph[,correlated[6:10]], cex=0.1, fig=TRUE)

forpca <- pca.ph[,c(grep(paste(exclude1, collapse="|"),
                         names(pca.ph), value=TRUE, invert=TRUE))]



ph.pca <- princomp(forpca[,-(1:3)], cor=TRUE)
summary(ph.pca)
ph.load <- loadings(ph.pca)
ph.pc <- predict(ph.pca)

ph.pc <- data.frame(ph.pc, pca.ph)

summary(lm(Comp.1~alt, data=ph.pc))
```


```{r}
ggplot(ph.pc, aes(Comp.1, Comp.2, colour = cnts))+
  geom_point()+
  stat_ellipse()

```


redundancy analysis (RDA): combines PCA on allele frequencies and multiple regression
Meirmans Molecular Ecology "Seven common mistakes in pouplaiton genetics and how to avoid them"


<https://www.analyticsvidhya.com/blog/2016/04/complete-tutorial-tree-based-modeling-scratch-in-python/> 
```{r}


```
